<!--
  Generated template for the SalesOrderPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-menu side="right" id="country-filter" swipeEnabled="true" [content]="content">
    <ion-content>
        <ion-list check-group>
            <ion-item *ngFor="let item of countryData">
                <ion-label>{{item.Text}}</ion-label>
                <ion-checkbox [(ngModel)]="item.Checked">{{item.Text}}</ion-checkbox>
            </ion-item>
        </ion-list>
    </ion-content>
    <ion-footer>
        <ion-row no-padding>
            <ion-col no-padding>
                <button color="light" ion-button full (click)="cancelCountry()">{{ 'CancelButtonText' | translate }}</button>
            </ion-col>
            <ion-col no-padding>
                <button color="primary" ion-button full (click)="confirmCountry()">{{ 'OkeyButtonText' | translate }}</button>
            </ion-col>
        </ion-row>
    </ion-footer>
</ion-menu>

<ion-menu side="right" id="sales-person-filter" swipeEnabled="true" [content]="content">
    <ion-content>
        <ion-list check-group>
            <ion-item *ngFor="let item of salesPersonData">
                <ion-label>{{item.Text}}</ion-label>
                <ion-checkbox [(ngModel)]="item.Checked">{{item.Text}}</ion-checkbox>
            </ion-item>
        </ion-list>
    </ion-content>
    <ion-footer>
        <ion-row no-padding>
            <ion-col no-padding>
                <button color="light" ion-button full (click)="cancelSalesPerson()">{{ 'CancelButtonText' | translate }}</button>
            </ion-col>
            <ion-col no-padding>
                <button color="primary" ion-button full (click)="confirmSalesPerson()">{{ 'OkeyButtonText' | translate }}</button>
            </ion-col>
        </ion-row>
    </ion-footer>
</ion-menu>

<ion-menu side="right" id="sales-filter" swipeEnabled="true" [content]="content">
    <ion-content>
        <div class="filter-container">
            <ion-grid>
                <ion-row>
                    <ion-col no-padding>
                        <ion-input type="text" [(ngModel)]="customerName" placeholder="{{ 'SalesOrderPage.CustomerName' | translate }}"></ion-input>
                    </ion-col>
                </ion-row>
            </ion-grid>
            <ion-grid>
                <ion-row>
                    <ion-col no-padding>
                        <ion-label>{{ 'SalesOrderPage.SalesOrderCreateDate' | translate }}</ion-label>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <ion-datetime [(ngModel)]="createStartDate" displayFormat="YYYY-MM-DD" placeholder="{{ 'SalesOrderPage.StartDate' | translate }}"
                          doneText="{{ 'OKButtonText' | translate }}" cancelText="{{ 'CancelButtonText' | translate }}"></ion-datetime>
                    </ion-col>
                    <ion-col>
                        <ion-datetime [(ngModel)]="createEndDate" displayFormat="YYYY-MM-DD" placeholder="{{ 'SalesOrderPage.EndDate' | translate }}"
                          doneText="{{ 'OKButtonText' | translate }}" cancelText="{{ 'CancelButtonText' | translate }}"></ion-datetime>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <div class="radio">
                            <label for="radio1" class="unchecked" [ngClass]="{'checked':selectDate == '1'}">{{ 'SalesOrderPage.SalesOrderCreateDate1' | translate }}</label>
                            <input type="radio" name="radio" id="radio1" [(ngModel)]="selectDate" value="1" (change)="changeSalesOrderCreateDate(1)">
                        </div>
                    </ion-col>
                    <ion-col>
                        <div class="radio">
                            <label for="radio2" class="unchecked" [ngClass]="{'checked':selectDate == '2'}">{{ 'SalesOrderPage.SalesOrderCreateDate2' | translate }}</label>
                            <input type="radio" name="radio" id="radio2" [(ngModel)]="selectDate" value="2" (change)="changeSalesOrderCreateDate(2)">
                        </div>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <div class="radio">
                            <label for="radio3" class="unchecked" [ngClass]="{'checked':selectDate == '3'}">{{ 'SalesOrderPage.SalesOrderCreateDate3' | translate }}</label>
                            <input type="radio" name="radio" id="radio3" [(ngModel)]="selectDate" value="3" (change)="changeSalesOrderCreateDate(3)">
                        </div>
                    </ion-col>
                    <ion-col>
                        <div class="radio">
                            <label for="radio4" class="unchecked" [ngClass]="{'checked':selectDate == '4'}">{{ 'SalesOrderPage.SalesOrderCreateDate4' | translate }}</label>
                            <input type="radio" name="radio" id="radio4" [(ngModel)]="selectDate" value="4" (change)="changeSalesOrderCreateDate(4)">
                        </div>
                    </ion-col>
                </ion-row>
            </ion-grid>
            <ion-grid *ngIf="countryPageData&&countryPageData.length>0">
                <ion-row (click)="selectCountry()">
                    <ion-col no-padding>
                        <ion-label>{{ 'SalesOrderPage.CountryOrArea' | translate }}</ion-label>
                    </ion-col>
                    <ion-col text-right align-self-center style="width:145px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;word-break: break-all;">
                        <span *ngIf="country.length==0">{{ 'SalesOrderPage.All' | translate }}</span>
                        <span>{{country.join(",")}}</span>
                    </ion-col>
                    <ion-col align-self-center col-auto>
                        <ion-icon name="arrow-forward-outline"></ion-icon>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <div class="buttons">
                        <div *ngFor="let item of countryPageData;let i=index;">
                            <span class="unchecked" [ngClass]="{'checked':item.Checked}" (click)="selectCountryCheckbox(item,i)">{{item.Text}}</span>
                        </div>
                    </div>
                </ion-row>
            </ion-grid>
            <ion-grid *ngIf="salesPersonPageData&&salesPersonPageData.length>0">
                <ion-row (click)="selectSalesPerson()">
                    <ion-col no-padding>
                        <ion-label>{{ 'SalesOrderPage.SalesPerson' | translate }}</ion-label>
                    </ion-col>
                    <ion-col text-right align-self-center col-auto style="width:145px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;word-break: break-all;">
                        <span *ngIf="salesPerson.length==0">{{ 'SalesOrderPage.All' | translate }}</span>
                        <span>{{salesPerson.join(",")}}</span>
                    </ion-col>
                    <ion-col align-self-center col-auto>
                        <ion-icon name="arrow-forward-outline"></ion-icon>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <div class="buttons">
                        <div *ngFor="let item of salesPersonPageData;let i=index;">
                            <span class="unchecked" [ngClass]="{'checked':item.Checked}" (click)="selectSalesPersonCheckbox(item,i)">{{item.Text}}</span>
                        </div>
                    </div>
                </ion-row>
            </ion-grid>
        </div>
    </ion-content>
    <ion-footer>
        <ion-row no-padding>
            <ion-col no-padding>
                <button color="light" ion-button full (click)="resetFilter()">{{ 'ResetButtonText' | translate }}</button>
            </ion-col>
            <ion-col no-padding>
                <button color="primary" ion-button full (click)="filter()">{{ 'OkeyButtonText' | translate }}</button>
            </ion-col>
        </ion-row>
    </ion-footer>
</ion-menu>

<ion-header>
    <ion-navbar color="primary">
        <ion-buttons start>
            <button ion-button icon-only (click)="openMenu()">
                <ion-icon name="menu"></ion-icon>
            </button>
        </ion-buttons>
        <ion-title>{{ 'SalesOrderPage.Title' | translate }}</ion-title>
        <ion-buttons end>
            <button ion-button icon-only (click)="openSearch()">
                <ion-icon name="search"></ion-icon>
            </button>
            <button ion-button icon-only (click)="toggleFilter()">
                <ion-icon class="iconfont icon-filter2" style="font-size:1.9em;"></ion-icon>
            </button>
        </ion-buttons>
    </ion-navbar>
</ion-header>

<ion-content #content>
    <div class="sort-container">
        <ion-grid no-padding>
            <ion-row>
                <ion-col col-6>
                    <ion-select [(ngModel)]="orderBy" interface="popover" (ionChange)="onChangeOrderBy($event)">
                        <ion-option value="CustomerName ASC">{{ 'SalesOrderPage.CustomerNameASC' | translate }}</ion-option>
                        <ion-option value="SalesOrderNumber DESC">{{ 'SalesOrderPage.SalesOrderNumberDESC' | translate }}</ion-option>
                        <ion-option value="SalesOrderNumber ASC">{{ 'SalesOrderPage.SalesOrderNumberASC' | translate }}</ion-option>
                        <ion-option value="OrderCreatedDate DESC">{{ 'SalesOrderPage.OrderCreatedDateDESC' | translate }}</ion-option>
                        <ion-option value="OrderCreatedDate ASC">{{ 'SalesOrderPage.OrderCreatedDateASC' | translate }}</ion-option>
                    </ion-select>
                </ion-col>
                <ion-col col-6>
                    <ion-select [(ngModel)]="status" interface="popover" (ionChange)="onChangeSortFilter($event)">
                        <ion-option value="">{{ 'SalesOrderPage.All' | translate }}</ion-option>
                        <ion-option value="0">{{ 'SalesOrderPage.UnCompleted' | translate }}</ion-option>
                        <ion-option value="1">{{ 'SalesOrderPage.Completed' | translate }}</ion-option>
                    </ion-select>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>
    <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingIcon="arrow-round-down" refreshingSpinner="dots">
        </ion-refresher-content>
    </ion-refresher>
    <div class="list-container">
        <ion-grid *ngIf="!appService.isLoading&&data&&data.length==0">
            <ion-row justify-content-center>{{ 'SalesOrderPage.NoData' | translate }}</ion-row>
        </ion-grid>
        <ion-grid class="item" *ngFor="let item of data;let i=index">
            <ion-row class="item-header">
                <ion-col align-self-center (click)="openCustomerDashboard(item.CustomerCode)">
                    <span>{{item.CustomerName}}</span>
                </ion-col>
                <ion-col col-auto align-self-center text-right class="item-options">
                    <ion-icon color="primary" name="share-outline" (click)="share(item)"></ion-icon>
                    <ion-icon [color]="item.IsFavorite?'danger':'primary'" name="{{item.IsFavorite?'star':'star-outline'}}" (click)="favorite(item,i)"></ion-icon>
                </ion-col>
            </ion-row>
            <ion-row class="item-content" (click)="openSalesOrderItem(item.SalesOrderNumber)">
                <ion-col col-auto align-self-center class="item-icon">
                    <ion-icon [color]="item.Status === 1?'success':'danger'" name="{{item.Status==0?'md-arrow-dropright-circle':'checkmark-circle'}}"></ion-icon>
                </ion-col>
                <ion-col align-self-center class="item-field">
                    <span>{{item.SalesOrderNumber}}</span>
                    <span>{{item.PurchaseOrderNumber}}</span>
                </ion-col>
                <ion-col col-auto align-self-center text-right class="item-field">
                    <span>{{item.SalesPerson}}</span>
                    <span>{{item.OrderCreatedDate|date:'yyyy-MM-dd'}}</span>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>
    <ion-infinite-scroll *ngIf="hasMore" (ionInfinite)="doInfinite($event)">
        <ion-infinite-scroll-content loadingSpinner="dots"></ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>

