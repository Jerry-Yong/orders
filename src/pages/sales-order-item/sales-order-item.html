<!--
  Generated template for the SalesOrderItemPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-menu side="right" id="sales-item-filter" swipeEnabled="true" [content]="content">
    <ion-content>
        <div class="filter-container">
            <ion-grid>
                <ion-row>
                    <ion-col no-padding>
                        <ion-input type="text" [(ngModel)]="salesOrderItemNumber" placeholder="{{ 'SalesOrderItemPage.SalesOrderItemNumber' | translate }}"></ion-input>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col no-padding>
                        <ion-input type="text" [(ngModel)]="meterCode" placeholder="{{ 'SalesOrderItemPage.MeterCode' | translate }}"></ion-input>
                    </ion-col>
                </ion-row>
            </ion-grid>
            <ion-grid>
                <ion-row>
                    <ion-col no-padding>
                        <ion-label>{{ 'SalesOrderItemPage.EstimatedExWorkDate' | translate }}</ion-label>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <ion-datetime [(ngModel)]="estimatedExWorkStartDate" displayFormat="YYYY-MM-DD" placeholder="{{ 'SalesOrderItemPage.StartDate' | translate }}"
                          doneText="{{ 'OKButtonText' | translate }}" cancelText="{{ 'CancelButtonText' | translate }}"></ion-datetime>
                    </ion-col>
                    <ion-col>
                        <ion-datetime [(ngModel)]="estimatedExWorkEndDate" displayFormat="YYYY-MM-DD" placeholder="{{ 'SalesOrderItemPage.EndDate' | translate }}"
                          doneText="{{ 'OKButtonText' | translate }}" cancelText="{{ 'CancelButtonText' | translate }}"></ion-datetime>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <div class="radio">
                            <label for="radioEstimatedExWorkDate1" class="unchecked" [ngClass]="{'checked':selectEstimatedExWorkDate == 1}">{{ 'SalesOrderItemPage.EstimatedExWorkDate1' | translate }}</label>
                            <input type="radio" name="radioEstimatedExWorkDate" id="radioEstimatedExWorkDate1" [(ngModel)]="selectEstimatedExWorkDate"
                              value="1" (change)="changeEstimatedExWorkDate()">
                        </div>
                    </ion-col>
                    <ion-col>
                        <div class="radio">
                            <label for="radioEstimatedExWorkDate2" class="unchecked" [ngClass]="{'checked':selectEstimatedExWorkDate == 2}">{{ 'SalesOrderItemPage.EstimatedExWorkDate2' | translate }}</label>
                            <input type="radio" name="radioEstimatedExWorkDate" id="radioEstimatedExWorkDate2" [(ngModel)]="selectEstimatedExWorkDate"
                                value="2" (change)="changeEstimatedExWorkDate()">
                        </div>
                    </ion-col>
                </ion-row>
            </ion-grid>
            <ion-grid>
                <ion-row>
                    <ion-col no-padding>
                        <ion-label>{{ 'SalesOrderItemPage.ShippedDate' | translate }}</ion-label>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <ion-datetime [(ngModel)]="shippingStartDate" displayFormat="YYYY-MM-DD" placeholder="{{ 'SalesOrderItemPage.StartDate' | translate }}"
                            doneText="{{ 'OKButtonText' | translate }}" cancelText="{{ 'CancelButtonText' | translate }}"></ion-datetime>
                    </ion-col>
                    <ion-col>
                        <ion-datetime [(ngModel)]="shippingEndDate" displayFormat="YYYY-MM-DD" placeholder="{{ 'SalesOrderItemPage.EndDate' | translate }}"
                            doneText="{{ 'OKButtonText' | translate }}" cancelText="{{ 'CancelButtonText' | translate }}"></ion-datetime>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <div class="radio">
                            <label for="radioShippingDate1" class="unchecked" [ngClass]="{'checked':selectShippingDate == 1}">{{ 'SalesOrderItemPage.ShippingDate1' | translate }}</label>
                            <input type="radio" name="radioShippingDate" id="radioShippingDate1" [(ngModel)]="selectShippingDate" value="1" (change)="changeShippingDate()">
                        </div>
                    </ion-col>
                    <ion-col>
                        <div class="radio">
                            <label for="radioShippingDate2" class="unchecked" [ngClass]="{'checked':selectShippingDate == 2}">{{ 'SalesOrderItemPage.ShippingDate2' | translate }}</label>
                            <input type="radio" name="radioShippingDate" id="radioShippingDate2" [(ngModel)]="selectShippingDate" value="2" (change)="changeShippingDate()">
                        </div>
                    </ion-col>
                </ion-row>
            </ion-grid>
        </div>
    </ion-content>
    <ion-footer>
        <ion-row no-padding>
            <ion-col no-padding>
                <button color="light" ion-button full (click)="resetFilter()">{{ 'ResetButtonText' | translate }}</button>
            </ion-col>
            <ion-col no-padding>
                <button color="primary" ion-button full (click)="filter()">{{ 'OkeyButtonText' | translate }}</button>
            </ion-col>
        </ion-row>
    </ion-footer>
</ion-menu>


<ion-header>
    <ion-navbar color="primary">
        <ion-buttons start *ngIf="isSignIn">
            <button ion-button icon-only (click)="openMenu()">
                <ion-icon name="menu"></ion-icon>
            </button>
        </ion-buttons>
        <ion-title>{{ 'SalesOrderItemPage.Title' | translate }}</ion-title>
        <ion-buttons end>
            <button ion-button icon-only (click)="toggleFilter()">
                <ion-icon class="iconfont icon-filter2" style="font-size:1.9em;"></ion-icon>
            </button>
        </ion-buttons>
    </ion-navbar>
</ion-header>


<ion-content #content>
    <div class="sort-container">
        <ion-grid no-padding>
            <ion-row>
                <ion-col col-6>
                    <ion-select [(ngModel)]="orderBy" interface="popover" (ionChange)="onChangeSortFilter($event)">
                        <ion-option value="SalesOrderItemNumber Desc">{{ 'SalesOrderItemPage.SalesOrderItemNumberDESC' | translate }}</ion-option>
                        <ion-option value="SalesOrderItemNumber Asc">{{ 'SalesOrderItemPage.SalesOrderItemNumberASC' | translate }}</ion-option>
                        <ion-option value="EstimatedExWorkDate Desc">{{ 'SalesOrderItemPage.EstimatedExWorkDateDESC' | translate }}</ion-option>
                        <ion-option value="EstimatedExWorkDate Asc">{{ 'SalesOrderItemPage.EstimatedExWorkDateASC' | translate }}</ion-option>
                    </ion-select>
                </ion-col>
                <ion-col col-6>
                    <ion-select [(ngModel)]="status" interface="popover" (ionChange)="onChangeSortFilter($event)">
                        <ion-option value="">{{ 'SalesOrderItemPage.All' | translate }}</ion-option>
                        <ion-option value="0">{{ 'SalesOrderItemPage.OnPlan' | translate }}</ion-option>
                        <ion-option value="1">{{ 'SalesOrderItemPage.WIP' | translate }}</ion-option>
                        <ion-option value="2">{{ 'SalesOrderItemPage.Finished' | translate }}</ion-option>
                        <ion-option value="3">{{ 'SalesOrderItemPage.Shipped' | translate }}</ion-option>
                    </ion-select>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>
    <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingIcon="arrow-round-down" refreshingSpinner="dots">
        </ion-refresher-content>
    </ion-refresher>
    <div class="list-container">
        <ion-grid *ngIf="!appService.isLoading&&data&&data.length==0">
            <ion-row justify-content-center>{{ 'SalesOrderItemPage.NoData' | translate }}</ion-row>
        </ion-grid>
        <ion-grid class="item" *ngFor="let item of data;let i=index">
            <ion-row class="item-header">
                <ion-col col align-self-center (click)="openSalesOrderItemDetail(item)">{{item.SalesOrderNumber}} - {{item.SalesOrderItemNumber}}</ion-col>
                <ion-col col-auto align-self-center text-right class="item-options">
                    <ion-icon color="primary" name="share-outline" (click)="share(item)"></ion-icon>
                    <ion-icon [color]="item.IsFavorite?'danger':'primary'" name="{{item.IsFavorite?'star':'star-outline'}}" (click)="favorite(item,i)" *ngIf="isSignIn"></ion-icon>
                </ion-col>
            </ion-row>
            <ion-row class="item-content" (click)="openSalesOrderItemDetail(item)">
                <ion-col col-auto align-self-center class="item-icon">
                    <ion-icon *ngIf="item.Status==0" class="iconfont icon-jihua" color="primary"></ion-icon>
                    <ion-icon *ngIf="item.Status==1" class="iconfont icon-shengchan" color="primary"></ion-icon>
                    <ion-icon *ngIf="item.Status==2" class="iconfont icon-cangku" color="primary"></ion-icon>
                    <ion-icon *ngIf="item.Status==3" class="iconfont icon-yifahuo" color="primary"></ion-icon>
                </ion-col>
                <ion-col align-self-center class="item-field">
                    <span *ngIf="!item.EstimatedExWorkDate">{{ 'SalesOrderItemPage.PlanExWorkOn' | translate }} TBD</span>
                    <span *ngIf="item.EstimatedExWorkDate">{{ 'SalesOrderItemPage.PlanExWorkOn' | translate }} {{item.EstimatedExWorkDate|date:'yyyy-MM-dd'}}</span>
                    <span>{{item.MeterCode}}</span>
                </ion-col>
                <ion-col col-auto align-self-center text-right class="item-field">
                    <span>{{item.TotalQuantity}} {{item.Unit}}</span>
                    <span>&nbsp;</span>
                </ion-col>
            </ion-row>
        </ion-grid>
        <ion-infinite-scroll *ngIf="hasMore" (ionInfinite)="doInfinite($event)">
            <ion-infinite-scroll-content loadingSpinner="dots">
            </ion-infinite-scroll-content>
        </ion-infinite-scroll>
    </div>
</ion-content>
